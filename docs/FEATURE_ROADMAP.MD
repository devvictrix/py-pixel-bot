# Feature Roadmap & Status

This document tracks planned features and their status for this visual automation tool. The project has progressed through initial versions, including a significant "AI-Accelerated v1.0.0" release, "v2.0.0" (advanced analysis/rules), and "v3.0.0" (Enhanced GUI & Usability). The current major focus is **"v4.0.0 (Gemini-Powered Visual Intelligence)"**.

**Key Supporting Documents:**

- `PROJECT_OVERVIEW.MD`
- `TECHNICAL_DESIGN.MD`
- `STATUS_LEGEND.MD`
- `DEV_CONFIG.MD`
- `adrs/` (especially `ADR-008` for v4.0.0)

---

## Granular Feature Breakdown (Historical & Planned)

| Version                                                                                 | Status      | Priority | Epic                     | Feature Name                                          | Description                                                                                                                                                                                                                        | Notes / Key Libraries                                                                                                         |
| :-------------------------------------------------------------------------------------- | :---------- | :------- | :----------------------- | :---------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------- |
| **v0.0.x (Core Foundations & Basic Visual PoCs) - Components of AI-Accelerated v1.0.0** |
| `v0.0.1`                                                                                | Done        | Critical | Core Capture PoC         | Define Region (Coordinates) & Capture Image           | Allow user to define a single rectangular region via (x,y,w,h) in config. Capture a single image of this region.                                                                                                                   | `OpenCV-Python`, `Pillow`, `json`.                                                                                            |
| `v0.0.1`                                                                                | Done        | Critical | Basic Setup              | Project Structure, Initial Docs, Logging Foundation   | Setup basic project folders, virtual env, core docs, foundational logging setup (per ADR-007) based on `APP_ENV`.                                                                                                                  | Manual setup, `python-dotenv`, `logging`.                                                                                     |
| `v0.0.2`                                                                                | Done        | Critical | Basic Analysis PoC       | Specific Pixel Color Check                            | In the captured region, check the color of a specific predefined pixel.                                                                                                                                                            | `OpenCV-Python` (NumPy).                                                                                                      |
| `v0.0.2`                                                                                | Done        | High     | Basic Control PoC        | CLI - Trigger Capture & Basic Analysis (Conceptual)   | Basic CLI command to trigger one-shot capture and pixel color check (now part of full CLI).                                                                                                                                        | `argparse`.                                                                                                                   |
| `v0.0.3`                                                                                | Done        | Critical | Basic Action PoC         | Conditional Mouse Click (Fixed Pos - Evolved)         | IF pixel color IS specific_color, THEN simulate a mouse click. (Evolved to richer actions).                                                                                                                                        | `pyautogui`.                                                                                                                  |
| `v0.0.3`                                                                                | Done        | High     | Configuration PoC        | Load Region & Pixel Check Params from File            | Load region coords, target pixel offset, and expected color from a JSON config file.                                                                                                                                               | `json` module.                                                                                                                |
| **v0.1.0 (Core Modules & Basic Interactions - Components of AI-Accelerated v1.0.0)**    |
| v0.1.0                                                                                  | Done        | Critical | Region Management        | Multiple Region Definitions (Config)                  | Allow defining multiple named regions in the config file.                                                                                                                                                                          | `json`.                                                                                                                       |
| v0.1.0                                                                                  | Done        | Critical | Enhanced Analysis        | Average Color of Region/Sub-region                    | Calculate the average color of the entire defined region or a sub-rectangle within it.                                                                                                                                             | `OpenCV-Python`, `NumPy`.                                                                                                     |
| v0.1.0                                                                                  | Done        | Critical | Enhanced Actions         | Click within Target Region                            | IF condition MET, click at specific relative coordinates _within_ the monitored region, or its center.                                                                                                                             | `pyautogui`.                                                                                                                  |
| v0.1.0                                                                                  | Done        | Critical | Core Loop                | Continuous Monitoring Loop (Fixed Interval)           | Implement a threaded loop that repeatedly captures, analyzes, and potentially acts.                                                                                                                                                | `threading`, `time`.                                                                                                          |
| v0.1.0                                                                                  | Done        | Critical | CLI Controls             | CLI - Start/Stop Monitoring, Load Profile             | Functional CLI (`argparse`) to load a profile, start/stop continuous monitoring.                                                                                                                                                   | `argparse`.                                                                                                                   |
| **v0.2.0 (Template Matching & Improved Rules - Components of AI-Accelerated v1.0.0)**   |
| v0.2.0                                                                                  | Done        | Critical | Advanced Analysis        | Basic Template (Image) Matching                       | User provides template image. Bot searches for this template. Reports if found, location, confidence. Template loading implemented.                                                                                                | `OpenCV-Python`.                                                                                                              |
| v0.2.0                                                                                  | Done        | Critical | Enhanced Actions         | Click Relative to Found Template                      | IF template IS found, click at an offset relative to the template's found location.                                                                                                                                                | `pyautogui`.                                                                                                                  |
| v0.2.0                                                                                  | Done        | High     | Rules Engine             | Simple Rules (IF visual_event THEN action)            | Formalize rule structure in config (per ADR-004 Option 1).                                                                                                                                                                         | `json` for rules.                                                                                                             |
| v0.2.0                                                                                  | Done        | Medium   | Performance              | Configurable FPS/Delay for Monitoring Loop            | Allow user to configure the speed of the continuous monitoring loop via profile settings.                                                                                                                                          | Profile parameter.                                                                                                            |
| **v0.3.0 (OCR Integration - Components of AI-Accelerated v1.0.0)**                      |
| v0.3.0                                                                                  | Done        | Critical | Advanced Analysis        | OCR - Text Extraction from Region                     | Extract text from the monitored region using Tesseract.                                                                                                                                                                            | `pytesseract`, `OpenCV-Python`.                                                                                               |
| v0.3.0                                                                                  | Done        | Critical | Rules Engine             | Text-Based Conditions                                 | Rules like: "IF text CONTAINS 'keyword' THEN action".                                                                                                                                                                              | String matching.                                                                                                              |
| v0.3.0                                                                                  | Done        | High     | Action Execution         | Basic Keyboard Input Action                           | IF condition MET, simulate typing a predefined string or pressing specific keys.                                                                                                                                                   | `pyautogui`.                                                                                                                  |
| v0.3.0                                                                                  | Done        | Medium   | Error Handling           | Basic OCR Error Handling                              | Handle Tesseract not found or OCR failures.                                                                                                                                                                                        | Try-except, logging.                                                                                                          |
| **v0.4.0 (Basic GUI for Region Definition - Components of AI-Accelerated v1.0.0)**      |
| v0.4.0                                                                                  | Done        | High     | Usability                | GUI Tool for Region Selection                         | GUI (`CustomTkinter`) to draw, name, confirm regions.                                                                                                                                                                              | `CustomTkinter`.                                                                                                              |
| v0.4.0                                                                                  | Done        | Medium   | Configuration            | GUI for Profile Management (Add Region to Profile)    | CLI command `--add-region` uses GUI to update profile via `ConfigManager`.                                                                                                                                                         | `CustomTkinter`, `ConfigManager`.                                                                                             |
| **v1.0.0 (AI-Accelerated Release) - STABILIZATION & DOCUMENTATION**                     |
| v1.0.0                                                                                  | Done        | Critical | Integration & Testing    | Consolidate & Test All AI-Accelerated v1.0.0 Features | Thoroughly test the `run` and `add-region` commands with various profiles and screen conditions. Identify and fix bugs. Log extensively.                                                                                           | All modules.                                                                                                                  |
| v1.0.0                                                                                  | Done        | High     | Documentation            | User Guide & README Finalization                      | Review and finalize the `README.md` to ensure it's accurate, clear, and complete for a v1.0.0 user. Add more example profiles.                                                                                                     | Markdown.                                                                                                                     |
| v1.0.0                                                                                  | Done        | Critical | Error Handling           | Robust Global Error Handling & Logging Review         | Final review of error messages and log clarity based on testing experiences. Ensure graceful failure modes.                                                                                                                        | Python `logging`, try-except.                                                                                                 |
| **v2.0.0 (Advanced Visual Analysis & Rules) - COMPLETED**                               |
| v2.0.0                                                                                  | Done        | High     | Rules Engine Enhancement | Compound Conditions (AND/OR Logic)                    | Evolve RulesEngine to support ADR-004 Option 2: multiple conditions per rule with AND/OR logic.                                                                                                                                    | Enhanced `rules_engine.py`, JSON profile schema update.                                                                       |
| v2.0.0                                                                                  | Done        | High     | Advanced Analysis        | OCR Confidence Thresholds in Rules                    | Allow rules to use OCR confidence scores (e.g., "IF text CONTAINS 'X' AND confidence > 0.85").                                                                                                                                     | `pytesseract` features, `rules_engine.py`.                                                                                    |
| v2.0.0                                                                                  | Done        | Medium   | Advanced Analysis        | Color Palette Analysis / Dominant Color               | Analyze region for dominant colors using K-Means. Rules can check against these.                                                                                                                                                   | `OpenCV-Python` (k-means).                                                                                                    |
| v2.0.0                                                                                  | Done        | Medium   | Rules Engine             | Variables in Rules / Actions                          | Allow defining temporary rule-scoped variables from analysis (OCR, template match) and using them in subsequent conditions/actions.                                                                                                | `rules_engine.py` (variable context, substitution).                                                                           |
| v2.0.0                                                                                  | Done        | Medium   | Performance              | Selective Analysis per Rule                           | Optimize `MainController` to only run specific general analyses (OCR, dominant color) on a region if an active rule requires it.                                                                                                   | `main_controller.py`, `rules_engine.py` interaction.                                                                          |
| **Internal (Non-functional / DX)**                                                      |
| N/A                                                                                     | Done        | High     | Developer Experience     | Flake8 & Black Configuration                          | Configure Flake8 and Black for consistent linting and formatting (line length 99). `logging_setup.py` updated.                                                                                                                     | `.flake8`, `pyproject.toml`.                                                                                                  |
| N/A                                                                                     | Done        | Critical | Core System              | Fix CLI `run` Command Issues (Path & Imports)         | Corrected project root detection in `ConfigManager` and missing `os`/`Callable`/`APP_ROOT_LOGGER_NAME` usage/imports in `MainController`, `AnalysisEngine`, `RulesEngine`, `ActionExecutor` to enable `run` command functionality. | `config_manager.py`, `main_controller.py`, `analysis_engine.py`, `rules_engine.py`, `action_executor.py`, `logging_setup.py`. |
| **v3.0.0 (Enhanced GUI & Usability) - COMPLETED**                                       |
| v3.0.0                                                                                  | Done        | High     | Usability                | Full GUI for Profile & Rule Configuration             | A comprehensive GUI (`MainAppWindow`) to visually create/edit profiles: regions, templates, rules (conditions, actions, parameters, structure conversion), settings. Includes robust input validation and refinements.             | `CustomTkinter`. Fully implemented and tested.                                                                                |
| v3.0.0                                                                                  | Done        | Low      | Usability                | GUI - Sub-condition/Rule Reordering (Simple)          | Added simple "Move Up/Down" buttons for sub-conditions and rules in the GUI editor lists.                                                                                                                                          | `CustomTkinter`. Implemented.                                                                                                   |
| v3.0.0                                                                                  | Not Started | Medium   | Usability                | Real-time Visual Feedback in GUI                      | GUI shows live view of monitored region(s), overlays detected elements (templates, text boxes) for easier debugging/setup of rules.                                                                                                | `OpenCV-Python` with GUI library. Deferred.                                                                                     |
| v3.0.0                                                                                  | Not Started | Medium   | Action Execution         | Chained Actions / Simple Macros                       | Allow defining a sequence of multiple actions to be performed if a single condition is met.                                                                                                                                        | Data structure for action sequences in profile, `action_executor.py`. Deferred.                                                 |
| v3.0.0                                                                                  | Not Started | Medium   | Usability                | Profile Importer/Exporter                             | Simple way to share bot profiles.                                                                                                                                                                                                  | `ConfigManager` enhancements. Deferred.                                                                                         |
| **v3.0.x (Post-Core GUI Stability - Internal Refactoring)**                             |
| v3.0.x                                                                                  | Done        | Medium   | DX/Maintainability       | GUI Component Refactoring                             | Refactored `MainAppWindow` and `DetailsPanel` into smaller, more specialized components (e.g., `RegionDetailView`, `RuleDetailView` with `ConditionEditorView`, `ActionEditorView`) for improved modularity. Strategy in `TECHNICAL_DESIGN.MD` Section 9.8. | `CustomTkinter`. Refactoring complete.                                                                                          |
| **v4.0.0 (Gemini-Powered Visual Intelligence) - NEW / CURRENT FOCUS**                   |
| v4.0.0 (Phase 1)                                                                        | Done        | Critical | Gemini Integration       | `GeminiAnalyzer` Module - Core API Client             | Create a module to handle communication with the Gemini API (Vision models), including API key management (from .env), request formation, response parsing, and error handling. See ADR-008.                                            | `google-generativeai` SDK. Implemented core class, methods, image prep, response parsing, error handling, logging.             |
| v4.0.0 (Phase 1)                                                                        | Done        | Critical | Gemini Integration       | New Condition Type: `gemini_vision_query`             | Integrate `GeminiAnalyzer` into `RulesEngine` by adding a new condition type (`gemini_vision_query`). Params: `prompt`, `expected_response_contains`, `capture_as`, etc. (see ADR-008).                                         | `rules_engine.py`, JSON schema. Modified `__init__` and `_evaluate_single_condition_logic`. Basic dot-notation JSONPath access. |
| v4.0.0 (Phase 1)                                                                        | Done        | High     | Usability (Gemini)       | GUI Support for `gemini_vision_query` Conditions      | Update `MainAppWindow` and `DetailsPanel` to allow users to create, edit, and configure `gemini_vision_query` conditions, including prompt input and response expectation parameters.                                                  | `CustomTkinter`, `gui_config.py`. `gui_config.py` updated. `MainAppWindow` updated for settings. `DetailsPanel` picks up new config & textbox height. |
| v4.0.0 (Phase 1)                                                                        | Testing     | High     | Gemini Integration       | Testing: GUI, Engine, and Profile I/O for Gemini      | Thorough manual testing of creating, editing, saving, loading profiles with Gemini conditions. Test bot runs with Gemini rules. Verify error handling. Define mock strategy for `GeminiAnalyzer`.                                 | Manual testing by DevLead. `TECHNICAL_DESIGN.MD` updated with mock strategy.                                                    |
| v4.0.0 (Phase 1)                                                                        | In Progress | High     | Documentation (Gemini)   | Gemini Integration User Guide & NFRs                  | Document API key setup, costs, privacy, prompt engineering best practices, and NFRs (latency, internet) related to Gemini features (see ADR-008). Needs update across Requirements, NFRs, Tech Design, README.                        | Markdown. Updated `README.md`, `FUNCTIONAL_REQUIREMENTS.MD`, `NON_FUNCTIONAL_REQUIREMENTS.MD`. Review of `TECHNICAL_DESIGN.MD`. |
| v4.0.0 (Phase 1)                                                                        | Not Started | Medium   | Advanced Actions (Gemini)| Action on Gemini-Identified Element Bounding Box    | (Stretch Goal) Allow actions (e.g., click) to target coordinates derived from bounding boxes returned by Gemini for identified elements (see ADR-008).                                                                            | `action_executor.py`, `rules_engine.py` (variable handling).                                                                  |
| **vFuture (Advanced Enhancements & Integrations - Post v4.0.0 Phase 1)**                |
| vFuture                                                                                 | Not Started | Medium   | Advanced Analysis        | Fuzzy Template Matching & Tolerance                   | Allow template matching with varying degrees of tolerance for slight changes in color, rotation, or scale.                                                                                                                         | Advanced `OpenCV-Python` techniques.                                                                                          |
| vFuture                                                                                 | Not Started | Medium   | Advanced Analysis        | Motion/Change Detection within Region                 | Detect if any significant visual change or motion occurs within a monitored region, not just static states.                                                                                                                        | Frame differencing, background subtraction.                                                                                   |
| vFuture                                                                                 | Not Started | Low      | Advanced Analysis        | Basic Object/Shape Detection (Simplified)             | Detect simple geometric shapes (circles, rectangles) or basic pre-trained objects.                                                                                                                                                 | `OpenCV-Python` (contour detection, basic ML models if lightweight).                                                          |
| vFuture                                                                                 | Not Started | High     | Advanced Actions         | Dynamic Action Parameters based on Analysis           | Enhance action execution to better use data extracted during analysis (e.g., type OCR'd number, click at OCR'd text location). Includes Gemini-derived data.                                                                   | Enhanced `action_executor.py`, `rules_engine.py`.                                                                             |
| vFuture                                                                                 | Not Started | Low      | Advanced Actions         | Sound Alerts / System Notifications                   | Play a sound or send a system notification when a condition is met.                                                                                                                                                                | `playsound` library, platform-specific notification libs.                                                                     |
| vFuture                                                                                 | Not Started | Medium   | Integration              | Webhook / API Call Action                             | Allow the bot to send an HTTP request to an external service when a condition is met.                                                                                                                                              | `requests` library. Potential ADR for security/config.                                                                        |
| vFuture                                                                                 | Not Started | High     | Usability                | Visual Logging & Debugging History                    | Save snapshots of monitored regions when rules trigger/fail. Provide a visual history or step-through for debugging rules.                                                                                                         | Image saving, GUI enhancements. Potential ADR.                                                                                |
| vFuture                                                                                 | Not Started | Medium   | Usability                | Region/Rule Library & Reusability                     | Allow users to save and import/export individual regions or rule definitions to be reused across different profiles.                                                                                                               | Enhanced `config_manager.py`.                                                                                                 |
| vFuture (Gemini Phase 2+)                                                               | Planning    | Low      | Gemini Integration       | Gemini-Informed Decision Making (Dynamic Actions)     | Based on Gemini's visual analysis and a high-level goal, PyPixelBot (potentially with another Gemini text call) selects/parameterizes actions from a limited set or simple sequence. *This starts to approach "AI creates rule on the fly"*. | New `GeminiDecisionModule`. Research/Design needed.                                                                           |
| vFuture (Gemini Phase 3+)                                                               | Not Started | Very Low | Gemini Integration       | Dynamic Rule/Plan Formulation by Gemini               | Highly ambitious: Gemini formulates a multi-step plan (sequence of conditions/actions) to achieve a user goal based on continuous visual analysis. Significant safety and reliability challenges. *This is the "100% free" vision.* | Advanced agent-based architecture. Likely requires different model/approach.                                                  |

---

**Summary & Next Steps:**

- **v1.0.0, v2.0.0, v3.0.0 Complete.**
- **v4.0.0 (Gemini-Powered Visual Intelligence): This is the active development target.**
    -   **Current Focus: Phase 1 - Core Integration.**
    -   **Status:**
        -   Design documents (`ADR-008`, `TECHNICAL_DESIGN.MD`, Requirements, NFRs) updated.
        -   `DEV_CONFIG.MD` and `AI_INSTRUCTIONS.MD` aligned.
        -   `GeminiAnalyzer` module implementation is **Done**.
        -   `requirements.txt` updated.
        -   `gemini_vision_query` condition integration into `RulesEngine` is **Done**.
        -   GUI Support for Gemini configuration is **Done**.
        -   `TECHNICAL_DESIGN.MD` (Section 12) updated with `GeminiAnalyzer` mocking strategy.
        -   **Documentation for Gemini integration (`README.md`, `FUNCTIONAL_REQUIREMENTS.MD`, `NON_FUNCTIONAL_REQUIREMENTS.MD`) has been updated.**
    -   **Next Steps:**
        1.  **DevLead Manual Testing & Validation (CRITICAL):** DevLead to perform comprehensive manual testing of all Gemini-related features:
            *   GUI: Create, edit, save, load profiles with `gemini_vision_query` conditions (various parameters).
            *   Runtime: Execute profiles with Gemini conditions, verifying `RulesEngine` behavior, `GeminiAnalyzer` calls, response evaluation, variable capture, and action triggering.
            *   Error Handling: Test scenarios like invalid/missing API key, network down during Gemini call, blocked prompts/responses, invalid JSON paths, etc. Ensure graceful failure and informative logging.
            *   Review logs for clarity and completeness of Gemini interaction details.
        2.  **(Post-Testing) Refinements & Bug Fixing:** Address any issues or usability concerns identified during DevLead's testing.
        3.  **(Stretch Goal for Phase 1 / Start of Phase 2):** If core Phase 1 is stable and well-tested, proceed with detailed design and implementation for "Action on Gemini-Identified Element Bounding Box." This will involve updates to `GeminiAnalyzer` (if needed for structured box parsing), `RulesEngine` (for capturing complex box data), `ActionExecutor` (new target relation), and GUI (`gui_config.py`, `DetailsPanel`).
- **Focus for Gemini Phase 1 (v4.0.0):**
    - Enable PyPixelBot to **query Gemini Vision API** with screen region images and text prompts.
    - Allow rules to **use Gemini's responses** as conditions.
    - Provide GUI tools for users to **configure these Gemini-powered conditions**.
    - Ensure **NFRs** (latency, cost, privacy, internet dependency, API key security) are addressed and documented.
- **Future Gemini Phases (Post v4.0.0 Phase 1):**
    - **Phase 1 Stretch/Phase 2:** Action on Gemini-Identified Element Bounding Box.
    - **Phase 2+:** Explore using Gemini's reasoning to assist in selecting or parameterizing actions.
    - **Phase 3+:** Investigate highly autonomous behavior where Gemini formulates multi-step plans.

---